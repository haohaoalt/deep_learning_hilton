æ·±åº¦å­¦ä¹ å¤§ä½œä¸šä¹‹è·Ÿç€Hiltonå­¦æ·±åº¦ç¥ç»ç½‘ç»œ

## **1. æ–‡ä»¶ç»“æ„è¯´æ˜**

deep_learning_hilton

- README.md 
- autoencoder_matlab  %Hilton autoencoder è®ºæ–‡matlabä»£ç 
- homework

  - ae.py

  - bonus
  - data
  - main.py
  - rbm.py
  - saves
  - utils.py

- paper
  - science.pdf  Reducing the dimensionality of data with neural networks 
  - science_som.pdf

è¿è¡Œæ–¹æ³•ï¼š

```shell
# è®ºæ–‡matlabä»£ç è¿è¡Œæ–¹å¼
run mnistdeepauto.m in matlab
# run mnistclassify.m in matlab
# è®ºæ–‡ä»£ç pythonå¤ç°
python main.py
```

## **2. è®ºæ–‡ç†è§£**

â€‹		æ·±åº¦å­¦ä¹ ç”±äºBPç®—æ³•åœ¨1991å¹´è¢«æŒ‡å‡ºå­˜åœ¨æ¢¯åº¦æ¶ˆå¤±é—®é¢˜æ—¶è€Œé™·å…¥ä½è°·ã€‚å½“æ—¶è¿˜æ²¡æœ‰Adamç­‰ä¼˜åŒ–å™¨ï¼Œä¹Ÿè¿˜æ²¡æœ‰å·ç§¯ç¥ç»ç½‘ç»œï¼Œåªæœ‰å¤šå±‚æ„ŸçŸ¥å™¨ã€‚åˆ°06å¹´è¿™æ˜¯ç¬¬ä¸€æ¬¡æå‡ºæœ‰æ•ˆè§£å†³æ¢¯åº¦æ¶ˆå¤±é—®é¢˜çš„è§£å†³æ–¹æ¡ˆï¼š**æ— ç›‘ç£é¢„è®­ç»ƒå¯¹æƒå€¼è¿›è¡Œåˆå§‹åŒ–+æœ‰ç›‘ç£è®­ç»ƒå¾®è°ƒ**ï¼Œå¹¶ä¸”é‡æ–°è®©æ·±åº¦å­¦ä¹ æ€èµ·æµªæ½®ã€‚æ·±åº¦è‡ªç¼–ç å™¨é¦–å…ˆç”¨å—é™ç»å°”å…¹æ›¼æœºè¿›è¡Œé€å±‚é¢„è®­ç»ƒï¼Œå¾—åˆ°åˆå§‹çš„æƒå€¼ä¸åç½®ï¼ˆæƒå€¼ä¸åç½®çš„æ›´æ–°è¿‡ç¨‹ç”¨å¯¹æ¯”æ•£åº¦CD-1ç®—æ³•ï¼‰ã€‚ç„¶åï¼Œè‡ªç¼–ç å¾—åˆ°é‡æ„æ•°æ®ï¼Œé€šè¿‡BPç®—æ³•è¿›è¡Œå…¨å±€å¾®è°ƒæƒå€¼ä¸åç½®ï¼ˆæƒå€¼ä¸åç½®çš„æ›´æ–°è¿‡ç¨‹ç”¨Polak-Ribiereå…±è½­æ¢¯åº¦æ³•ï¼‰ã€‚

>  å‚è€ƒï¼šhttps://zhuanlan.zhihu.com/p/430436914

â€‹		æ–‡ç« æƒ³è¦è§£å†³ä¸¤ä¸ªé—®é¢˜ï¼š

- **BPç®—æ³•çš„æ¢¯åº¦æ¶ˆå¤±**

â€‹		å¤šå±‚æ„ŸçŸ¥æœºä¸Šä¸–çºªè¢«æå‡ºå´æ²¡æœ‰å¹¿æ³›åº”ç”¨å…¶åŸå› åœ¨äºå¯¹å¤šå±‚éçº¿æ€§ç½‘ç»œè¿›è¡Œæƒå€¼ä¼˜åŒ–æ—¶å¾ˆéš¾å¾—åˆ°å…¨å±€çš„å‚æ•°ã€‚å› ä¸ºä¸€èˆ¬ä½¿ç”¨æ•°å€¼ä¼˜åŒ–ç®—æ³•ï¼ˆæ¯”å¦‚BPç®—æ³•ï¼‰æ—¶éœ€è¦éšæœºç»™ç½‘ç»œèµ‹ä¸€ä¸ªå€¼ï¼Œè€Œå½“è¿™ä¸ªæƒå€¼å¤ªå¤§çš„è¯ï¼Œå°±å¾ˆå®¹æ˜“æ”¶æ•›åˆ°â€œå·®â€çš„å±€éƒ¨æ”¶æ•›ç‚¹ï¼Œæƒå€¼å¤ªå°çš„è¯åˆ™åœ¨è¿›è¡Œè¯¯å·®åå‘ä¼ é€’æ—¶ç¦»è¾“å…¥å±‚è¶Šè¿‘çš„æƒå€¼æ›´æ–°è¶Šæ…¢ã€‚æ‰€ä»¥ï¼Œæœ¬æ–‡ä»**åˆå§‹åŒ–**çš„è§’åº¦å»è§£å†³è®­ç»ƒç»“æœä¸å¥½çš„é—®é¢˜ï¼ˆç›¸å¯¹çš„ï¼Œä¼˜åŒ–å™¨æ˜¯ä»BPç®—æ³•çš„è§’åº¦ä¼˜åŒ–ï¼‰ã€‚Hintonè®¾è®¡å‡ºæ¥çš„autoencoderæ·±åº¦ç½‘ç»œç¡®èƒ½å¤Ÿè¾ƒå¿«çš„æ‰¾åˆ°æ¯”è¾ƒå¥½çš„å…¨å±€æœ€ä¼˜ç‚¹ï¼Œå®ƒæ˜¯ç”¨æ— ç›‘ç£çš„æ–¹æ³•ï¼ˆè¿™é‡Œæ˜¯RBMï¼‰å…ˆåˆ†å¼€å¯¹æ¯å±‚ç½‘ç»œè¿›è¡Œè®­ç»ƒï¼Œç„¶åå°†å®ƒå½“ä½œæ˜¯åˆå§‹å€¼æ¥å¾®è°ƒï¼Œå®ç°æ•°æ®çš„é™ç»´ã€‚è¿™ç§æ–¹æ³•è¢«è®¤ä¸ºæ˜¯å¯¹PCAçš„ä¸€ä¸ªéçº¿æ€§æ³›åŒ–æ–¹æ³•ã€‚

-  **ç¥ç»ç½‘ç»œæ„æˆçš„éçº¿æ€§é™ç»´ç®—æ³•**

â€‹		åœ¨å‹ç¼©è¾“å…¥å‘é‡çš„ç»´åº¦æ–¹é¢ï¼ˆé™ç»´ï¼‰ï¼Œå¸¸ç”¨çš„æ˜¯PCAç®—æ³•ï¼ˆçº¿æ€§é™ç»´ï¼‰ã€‚åŸºäº1986å¹´ç”±Rumelhartæå‡ºçš„**å•å±‚**çš„è‡ªç¼–ç å™¨ï¼ˆautoencoderï¼‰ï¼Œæœ¬æ–‡æå‡ºä¸€ä¸ªæ–°çš„é™ç»´ç®—æ³•ï¼šç”±ä¸€ä¸ªéçº¿æ€§çš„ã€è‡ªé€‚åº”çš„**å¤šå±‚**çš„ç¼–ç å™¨ï¼ˆencoderï¼‰æ¥å°†é«˜ç»´çš„æ•°æ®è½¬åŒ–ä¸ºä½ç»´çš„ç¼–ç ï¼Œå’Œä¸€ä¸ªç›¸ä¼¼çš„è§£ç å™¨ï¼ˆdecoderï¼‰æ¥å°†ä½ç»´ç¼–ç æ¢å¤æˆåŸå§‹é«˜ç»´æ•°æ®ï¼Œæ•´ä¸ªç³»ç»Ÿæ„æˆä¸€ä¸ªè‡ªç¼–ç å™¨ï¼ˆautoencoderï¼Œä½†æ˜¯ç§°ä¸ºDAE/deep autoencoderæ›´åˆé€‚ï¼Œå¼•è‡ªè¯¥[åšå®¢](https://link.zhihu.com/?target=https%3A//blog.csdn.net/a819825294/article/details/53516980)ï¼‰ã€‚ è¯¥ç½‘ç»œç”¨BPç®—æ³•è¿›è¡Œè®­ç»ƒï¼Œæ‰€ä»¥ä¹Ÿå­˜åœ¨ä¸Šè¿°é—®é¢˜ã€‚æœ¬æ–‡çš„å…·ä½“ç›®æ ‡å°±åœ¨äºä¼˜åŒ–è¯¥ç®—æ³•ã€‚

â€‹		RBM å—é™ç»å°”å…¹æ›¼æœºå‚è€ƒè¥¿ç“œä¹¦ç¬¬äº”ç« , [å—ç“œä¹¦å¯¹åº”éƒ¨åˆ†](https://datawhalechina.github.io/pumpkin-book/#/chapter5/chapter5?id=_524)çš„å†…å®¹ã€‚ç”¨ RBM pretrain çš„ç»´åº¦ä¸º `[784, 2000, 1000, 500, 30, 500, 1000, 2000, 784]`çš„ Autoencoder æ¨¡å‹ã€‚æ¯ä¸€å±‚ç½‘æ ¼çš„é¢„è®­ç»ƒéƒ½é‡‡ç”¨RBMæ–¹æ³•ï¼Œç»™å®šä¸€å¼ è¾“å…¥å›¾åƒï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è°ƒæ•´ç½‘ç»œçš„æƒå€¼å’Œåç½®å€¼ä½¿å¾—ç½‘ç»œå¯¹è¯¥è¾“å…¥å›¾åƒçš„èƒ½é‡æœ€ä½ã€‚é‡‡ç”¨å¤šå±‚ç½‘ç»œï¼Œå³æŠŠç¬¬ä¸€å±‚ç½‘ç»œçš„è¾“å‡ºä½œä¸ºç¬¬äºŒå±‚ç½‘ç»œçš„è¾“å…¥ã€‚å¹¶ä¸”æ¯å¢åŠ ä¸€ä¸ªç½‘ç»œå±‚ï¼Œå°±ä¼šæé«˜ç½‘ç»œå¯¹è¾“å…¥æ•°æ®é‡æ„çš„logä¸‹ç•Œæ¦‚ç‡å€¼ï¼Œä¸”ä¸Šå±‚çš„ç½‘ç»œèƒ½å¤Ÿæå–å‡ºå…¶ä¸‹å±‚ç½‘ç»œæ›´é«˜é˜¶çš„ç‰¹å¾ã€‚å½“ç½‘ç»œçš„é¢„è®­ç»ƒè¿‡ç¨‹å®Œæˆåï¼Œæˆ‘ä»¬éœ€è¦æŠŠè§£ç éƒ¨åˆ†é‡æ–°æ‹¿å›æ¥å±•å¼€æ„æˆæ•´ä¸ªç½‘ç»œï¼Œç„¶åç”¨çœŸå®çš„æ•°æ®ä½œä¸ºæ ·æœ¬æ ‡ç­¾æ¥å¾®è°ƒç½‘ç»œçš„å‚æ•°ã€‚å½“ç½‘ç»œçš„è¾“å…¥æ•°æ®æ˜¯è¿ç»­å€¼æ—¶ï¼Œåªéœ€å°†å¯è§†å±‚çš„äºŒè¿›åˆ¶å€¼æ”¹ä¸ºæœä»æ–¹å·®ä¸º1çš„é«˜æ–¯åˆ†å¸ƒå³å¯ï¼Œè€Œç¬¬ä¸€ä¸ªéšå«å±‚çš„è¾“å‡ºä»ç„¶ä¸ºäºŒè¿›åˆ¶å˜é‡ã€‚åœ¨å®éªŒçš„åˆ†å±‚è®­ç»ƒè¿‡ç¨‹ä¸­ï¼Œå…¶ç¬¬ä¸€ä¸ªRBMç½‘ç»œçš„è¾“å…¥å±‚éƒ½æ˜¯å…¶å¯¹åº”çš„çœŸå®æ•°æ®ï¼Œä¸”å°†å€¼å½’ä¸€åŒ–åˆ°äº†ï¼ˆ0,1ï¼‰ã€‚è€Œå…¶å®ƒRBMçš„è¾“å…¥å±‚éƒ½æ˜¯ä¸Šä¸€ä¸ªRBMç½‘ç»œè¾“å‡ºå±‚çš„æ¦‚ç‡å€¼ï¼›ä½†æ˜¯åœ¨å®é™…çš„ç½‘ç»œç»“æ„ä¸­ï¼Œé™¤äº†æœ€åº•å±‚çš„è¾“å…¥å±‚å’Œæœ€é¡¶å±‚RBMçš„éšå«å±‚æ˜¯è¿ç»­å€¼å¤–ï¼Œå…¶å®ƒæ‰€æœ‰å±‚éƒ½æ˜¯ä¸€ä¸ªäºŒå€¼éšæœºå˜é‡ã€‚ æ­¤æ—¶æœ€é¡¶å±‚RBMçš„éšå«å±‚æ˜¯ä¸€ä¸ªé«˜æ–¯åˆ†å¸ƒçš„éšæœºå˜é‡ï¼Œå…¶å‡å€¼ç”±è¯¥RBMçš„è¾“å…¥å€¼å†³å®šï¼Œæ–¹å·®ä¸º1ã€‚

## **3. matlabä»£ç å¤ç°**

Hiltonä¸»é¡µ
http://www.cs.toronto.edu/~hinton/MatlabForSciencePaper.html


codeä¸»è¦æ˜¯2ä¸ªå•ç‹¬çš„å·¥ç¨‹ã€‚

- ç”¨MNISTæ•°æ®åº“æ¥è¿›è¡Œæ·±åº¦çš„autoencoderå‹ç¼©ï¼Œç”¨çš„æ˜¯æ— ç›‘ç£å­¦ä¹ ï¼Œè¯„ä»·æ ‡å‡†æ˜¯é‡æ„è¯¯å·®å€¼MSEã€‚æœ¬æ¬¡æ˜¯è®­ç»ƒ4ä¸ªéšå«å±‚çš„autoencoderæ·±åº¦ç½‘ç»œç»“æ„ï¼Œè¾“å…¥å±‚ç»´åº¦ä¸º784ç»´ï¼Œ4ä¸ªéšå«å±‚ç»´åº¦åˆ†åˆ«ä¸º1000,500,250,30ã€‚æ•´ä¸ªç½‘ç»œæƒå€¼çš„è·å¾—æµç¨‹æ¢³ç†å¦‚ä¸‹ï¼š

  1. é¦–å…ˆè®­ç»ƒç¬¬ä¸€ä¸ªrbmç½‘ç»œï¼Œå³è¾“å…¥å±‚784ç»´å’Œç¬¬ä¸€ä¸ªéšå«å±‚1000ç»´æ„æˆçš„ç½‘ç»œã€‚é‡‡ç”¨çš„æ–¹æ³•æ˜¯rbmä¼˜åŒ–ï¼Œè¿™ä¸ªè¿‡ç¨‹ç”¨çš„æ˜¯è®­ç»ƒæ ·æœ¬ï¼Œä¼˜åŒ–å®Œæ¯•åï¼Œè®¡ç®—è®­ç»ƒæ ·æœ¬åœ¨éšå«å±‚çš„è¾“å‡ºå€¼ã€‚
  2. åˆ©ç”¨1ä¸­çš„ç»“æœä½œä¸ºç¬¬2ä¸ªrbmç½‘ç»œè®­ç»ƒçš„è¾“å…¥å€¼ï¼ŒåŒæ ·ç”¨rbmç½‘ç»œæ¥ä¼˜åŒ–ç¬¬2ä¸ªrbmç½‘ç»œï¼Œå¹¶è®¡ç®—å‡ºç½‘ç»œçš„è¾“å‡ºå€¼ã€‚å¹¶ä¸”ç”¨åŒæ ·çš„æ–¹æ³•è®­ç»ƒç¬¬3ä¸ªrbmç½‘ç»œå’Œç¬¬4ä¸ªrbmç½‘ç»œã€‚
  3. å°†ä¸Šé¢4ä¸ªrbmç½‘ç»œå±•å¼€è¿æ¥æˆæ–°çš„ç½‘ç»œï¼Œä¸”åˆ†æˆencoderå’Œdecoderéƒ¨åˆ†ã€‚å¹¶ç”¨æ­¥éª¤1å’Œ2å¾—åˆ°çš„ç½‘ç»œå€¼ç»™è¿™ä¸ªæ–°ç½‘ç»œèµ‹åˆå€¼ã€‚
  4. ç”±äºæ–°ç½‘ç»œä¸­æœ€åçš„è¾“å‡ºå’Œæœ€åˆçš„è¾“å…¥èŠ‚ç‚¹æ•°æ˜¯ç›¸åŒçš„ï¼Œæ‰€ä»¥å¯ä»¥å°†æœ€åˆçš„è¾“å…¥å€¼ä½œä¸ºç½‘ç»œç†è®ºçš„è¾“å‡ºæ ‡ç­¾å€¼ï¼Œç„¶åé‡‡ç”¨BPç®—æ³•è®¡ç®—ç½‘ç»œçš„ä»£ä»·å‡½æ•°å’Œä»£ä»·å‡½æ•°çš„åå¯¼æ•°ã€‚
  5. åˆ©ç”¨æ­¥éª¤3çš„åˆå§‹å€¼å’Œæ­¥éª¤4çš„ä»£ä»·å€¼å’Œåå¯¼å€¼ï¼Œé‡‡ç”¨å…±è½­æ¢¯åº¦ä¸‹é™æ³•ä¼˜åŒ–æ•´ä¸ªæ–°ç½‘ç»œï¼Œå¾—åˆ°æœ€ç»ˆçš„ç½‘ç»œæƒå€¼ã€‚ä»¥ä¸Šæ•´ä¸ªè¿‡ç¨‹éƒ½æ˜¯æ— ç›‘ç£çš„ã€‚

  ![Image](https://tva1.sinaimg.cn/large/007dpYmwly8h2t6ry7jvzj30qw05ejrm.jpg)

  æœ€ç»ˆç»“æœï¼š

  test_error:   4.58756519908758 

  train_error:  4.38230235524354

  

- MNISTçš„æ‰‹å†™å­—ä½“è¯†åˆ«ï¼Œç½‘ç»œçš„é¢„è®­ç»ƒéƒ¨åˆ†ç”¨çš„æ˜¯æ— ç›‘ç£çš„ï¼Œç½‘ç»œçš„å¾®è°ƒéƒ¨åˆ†ç”¨çš„æ˜¯æœ‰ç›‘ç£çš„ã€‚è¯„ä»·æ ‡å‡†å‡†æ˜¯è¯†åˆ«ç‡æˆ–è€…é”™è¯¯ç‡ã€‚åœ¨MNISTæ•°æ®é›†ä¸Šï¼Œéšæœºåˆå§‹åŒ–çš„ç¥ç»ç½‘ç»œçš„æœ€ä¼˜é”™è¯¯ç‡ä¸º1.6%ï¼›SVMï¼ˆsupport vector machinesï¼Œæ”¯æŒå‘é‡æœºï¼‰åˆ™ä¸º1.4%ï¼›ç»“æ„ä¸º 784 - 500 - 500 - 200 - 10çš„ç½‘ç»œåœ¨é‡‡ç”¨æœ¬æ–‡æå‡ºçš„é¢„è®­ç»ƒæ–¹æ³•åé”™è¯¯ç‡ä¸‹é™åˆ°1.2%ã€‚
  
  test_crerr
  
  251.550965446241        7.05819398164967        5.97431327430693        5.73477124302898        5.93366446693345        5.76065634728710        5.61232084409794        5.18238004595161        5.02669525863520        5.25873765794806        5.72458145116393        5.81680083661501        6.33291565567338        6.40311081995889        6.54332412430685        7.10479724092344        7.27548457457018        7.69851781853759        7.71597392397768        7.76431304726476        8.12992500236058        8.62810421015263        8.94743176764003        9.27903476126801        9.48464220092207        9.91930128287717        10.0459292249364        10.6092033047883        10.7176198850718        10.8499250619729

## **4. pythonä»£ç å¤ç°**

é¦–å…ˆå¯¹äºè¿™ä¸ªå®éªŒä¸Šå±‚é€»è¾‘åº”æ˜¯: å®ç°å››ä¸ªç»´åº¦åˆ†åˆ«ä¸º `[784, 2000]`, `[2000, 1000]`, `[1000, 500]`, `[500, 30]` çš„ RBM æ¨¡å‹å¹¶è®­ç»ƒ, å°†å®ƒä»¬ä½œä¸º Autoencoder çš„ pretrain åŠ è½½, å³ RBM çš„propupä¸Autoencoder.encoderçš„ç‰¹å®šå±‚forwardä¸€è‡´; propdownä¸Autoencoder.decoderçš„ä¸€è‡´. pretrainåŠ è½½å, å†å¯¹ Autoencoder è¿›è¡Œfinetuning.

+ `main.py` ä¸­å®ç°äº†ä¸»è¦çš„æ•°æ®åŠ è½½ã€è®­ç»ƒã€æµ‹è¯•çš„ä¸Šå±‚é€»è¾‘.
+ `utils.py` ä¸­å®ç°äº†ä¸€äº›è¾…åŠ©æ“ä½œçš„å‡½æ•°, åŒ…æ‹¬ Dataloader.
+ `rbm.py` å’Œ `ae.py` ä¸­å®ç°äº† RBM å’Œ Autoencoder æ¨¡å‹.

> è¯¦ç»†ä»£ç è§deep_learning_hilton/homework/*

è¿™é‡Œå°†è‡ªå·±å®éªŒç»“æœåŠå›¾ç‰‡æ”¾åœ¨ä¸‹è¾¹å¯¹æ¯”ï¼š

![](https://img-blog.csdnimg.cn/65d0ea9a77fa46cba8ba8751b4c8970c.png)

<center>auto-encoder result ae: 0.8691</center>

![](https://img-blog.csdnimg.cn/de3d77cb5d3e476da07e8666ee474a5f.png)

<center>auto-encoder result rbm: 0.9083</center>

å¯ä»¥çœ‹å‡ºRBMé¢„è®­ç»ƒè‡ªåŠ¨ç¼–ç å™¨åçš„ç‰¹å¾å¯è§†åŒ–æ€§èƒ½æœ‰ä¸€å®šçš„æå‡ï¼

å› ä¸ºè‡ªå·±è®­ç»ƒç¡¬ä»¶ç®—åŠ›çš„é™åˆ¶ï¼Œè°ƒæ•´è¶…å‚æ”¹å–„çš„å®éªŒç»“æœå‚è€ƒhttps://github.com/G-U-N

![](https://img-blog.csdnimg.cn/1cbc85dafc954a56ad74dddacf3a0abe.png)

<center>Feature Visulization after Vanilla AutoEncoder!</center>

![](https://img-blog.csdnimg.cn/00ee8c5e7cb0435ebf05b61c8564bd1f.png)

<center>Feature Visulization after RBM pretrained AutoEncoder  Best!!!ğŸ‘

â€‹    

## **5. æ€»ç»“**

- æ‰¾å¯¹èµ„æ–™ï¼Œé¿å…é‡å¤é€ è½®å­ï¼›
- ç¼–ç¨‹å®ç°çš„èƒ½åŠ›éœ€è¦åŠ å¼ºï¼›
- ç®—åŠ›çš„é‡è¦æ€§ï¼›

> Thanks for the wonderful tutorial and framework provided by [ZhangYikaii](https://github.com/ZhangYikaii) in the [wiki](https://github.com/ZhangYikaii/Auxiliary-Material-for-AI-Platform-Application-Course/wiki/ä½œä¸š-è‡ªç¼–ç å™¨-(Autoencoder)).
>
> Thanks for https://github.com/G-U-N/Restricted-Boltzmann-machine-for-AutoEncoder
